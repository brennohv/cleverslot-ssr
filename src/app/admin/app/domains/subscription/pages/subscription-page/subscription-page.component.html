<div class="container">
  <div [libSpinner]="isSelectPlanLoading()" class="row column-gap-4 row-gap-4">
    @if (isLoading()) {
    <lib-spinner />
    } @else if (portalSessionX()?.checkoutSessionUrl) {
    <div class="col-12">
      <h2 class="main-header-page">
        <span [transloco]="I18N_PREFFIX + 'plan.title'"></span>
      </h2>
      <p class="lead">
        <span [transloco]="I18N_PREFFIX + 'plan.description'"></span>
      </p>
    </div>

    <!-- Plans -->
    @for (plan of plans(); track $index) {
    <div
      class="p-4 mt-3 rounded subscription-card d-flex flex-column align-items-center col-12 col-md-auto position-relative"
    >
      @if (portalSessionX()?.freeTrial) {
      <p
        class="c-secondary free-trial c-ligth-primary-text p-1 rounded d-flex align-items-center column-gap-2"
      >
        <mat-icon>verified</mat-icon>
        <span [transloco]="I18N_PREFFIX + 'plan.free-trial'"></span>
      </p>
      }
      <div class="d-flex column-gap-2 align-items-center p-2">
        <img src="/assets/icons/icon.png" alt="" />
        <div class="d-flex flex-column row-gap-1">
          <h4 class="fw-bold text-primary mb-1" style="font-size: 1.5rem">
            <span [transloco]="I18N_PREFFIX + plan.title"></span>
          </h4>
          <div class="d-flex align-items-center">
            <span
              class="fs-1 fw-bold text-success me-2"
              style="line-height: 1"
              >{{ plan.price | currency : "â‚¬" }}</span
            >
            <span class="text-muted" style="font-size: 1rem">
              <span [transloco]="I18N_PREFFIX + 'plan.per-month'"></span>
            </span>
          </div>
        </div>
      </div>

      <mat-divider class="w-100" />

      <div class="mt-3 d-flex flex-column row-gap-1">
        <p class="d-flex align-items-center column-gap-2">
          <mat-icon class="c-primary">check</mat-icon>
          <span [transloco]="I18N_PREFFIX + plan.accessMessage"></span>
        </p>
        <p class="d-flex align-items-center column-gap-2">
          <mat-icon class="c-primary">check</mat-icon>
          <span
            [transloco]="I18N_PREFFIX + plan.manageProfessionalMessage"
          ></span>
        </p>

        <a
          role="presentation"
          (click)="selectPlanSetup(plan.type)"
          class="btn btn-primary btn-lg"
        >
          {{
            portalSessionX()?.freeTrial
              ? (I18N_PREFFIX + "plan.start-free-trial" | transloco)
              : (I18N_PREFFIX + "plan.choose-plan" | transloco)
          }}
        </a>
      </div>
    </div>
    } } @else if (portalSessionX()?.portalSessionUrl) {
    <div class="col-12">
      <h2 class="main-header-page">
        <span [transloco]="I18N_PREFFIX + 'billing.title'"></span>
      </h2>
      <p class="lead">
        <span [transloco]="I18N_PREFFIX + 'billing.description'"></span>
      </p>
      <div class="mt-4">
        <a
          role="button"
          class="btn btn-primary btn-lg"
          [href]="portalSessionX()?.portalSessionUrl"
          target="_blank"
          rel="noopener noreferrer"
        >
          <span [transloco]="I18N_PREFFIX + 'billing.go-to-portal'"></span>
        </a>
      </div>
      <div class="mt-3 text-muted">
        <small
          ><span [transloco]="I18N_PREFFIX + 'billing.secure-powered'"></span>
          <strong>Stripe</strong>.</small
        >
      </div>
    </div>
    }
  </div>
</div>
